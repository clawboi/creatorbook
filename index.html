<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>CreatorBook</title>
  <meta name="theme-color" content="#06060a" />
  <link rel="stylesheet" href="assets/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="config.js"></script>
</head>
<body>
  <div class="bg"></div>

  <header class="topbar">
    <div class="brand">
      <span class="dot"></span>
      <span class="name">CREATORBOOK</span>
    </div>

    <nav class="nav">
      <a href="#home" data-nav="home">Home</a>
      <a href="#projects" data-nav="projects" class="authed">My Projects</a>
      <a href="#creator" data-nav="creator" class="authed">Creator Dashboard</a>
      <a href="#artist" data-nav="artist" class="authed">Artist Dashboard</a>
      <a href="#settings" data-nav="settings" class="authed">Settings</a>
    </nav>

    <div class="right">
      <div class="pill" id="whoPill" style="display:none;">
        <span id="whoName">User</span>
        <span class="sep">·</span>
        <span id="whoRole">client</span>
      </div>
      <button class="btn ghost" id="btnSignIn">Sign in</button>
      <button class="btn ghost authed" id="btnSignOut">Sign out</button>
    </div>
  </header>

  <main class="wrap">

    <!-- PUBLIC HOME (no login required) -->
    <section class="page" id="pageHome">
      <h1 class="heroTitle">Book LA creatives with tiers, credits, and a clean workflow.</h1>
      <p class="heroSub">Browse work first. Sign in only when you’re ready to book or get booked.</p>

      <div class="grid2">
        <div class="card">
          <div class="cardTitle">Explore</div>
          <div class="row">
            <select id="homeService">
              <option value="any">Any service</option>
              <option value="music_video">Music Video</option>
              <option value="photography">Photography</option>
              <option value="reels">Reels / Shorts</option>
              <option value="editing">Editing</option>
              <option value="fashion">Fashion (Rent)</option>
              <option value="producer">Producer</option>
            </select>
            <select id="homeTier">
              <option value="any">Any tier</option>
              <option value="bronze">Bronze</option>
              <option value="silver">Silver</option>
              <option value="gold">Gold</option>
              <option value="elite">Elite</option>
            </select>
            <button class="btn" id="homeRefresh">Refresh</button>
          </div>
          <div class="muted">This feed shows approved creators and their packages.</div>
        </div>

        <div class="card">
          <div class="cardTitle">How it works</div>
          <ol class="steps">
            <li>Browse creators + tiers.</li>
            <li>Sign in, choose Artist or Creator.</li>
            <li>Artists create a project → pick a creator → request a date → chat.</li>
            <li>Credits go into escrow when confirmed. Delivery → approval → rating.</li>
          </ol>
        </div>
      </div>

      <div class="card">
        <div class="cardTitle">Home Feed</div>
        <div id="feed" class="feed"></div>
        <div class="muted" id="feedEmpty" style="display:none;">No packages found. Try “Any”.</div>
      </div>
    </section>

    <!-- ROLE GATE (after login) -->
    <section class="page" id="pageRoleGate" style="display:none;">
      <h2 class="bigQ">Are you an Artist or a Creator?</h2>
      <p class="heroSub">Artists book projects. Creators get booked (approval required to appear publicly).</p>

      <div class="roleSplit">
        <button class="roleCard" id="pickArtist">
          <div class="roleTitle">Artist</div>
          <div class="roleSub">Create projects, pick tiers, book creators.</div>
        </button>
        <button class="roleCard" id="pickCreator">
          <div class="roleTitle">Creator</div>
          <div class="roleSub">Create packages (Bronze/Silver/Gold/Elite) and get booked.</div>
        </button>
      </div>

      <div class="card slim">
        <div class="muted">You can change this later in Settings. Creators must be approved by admin before they show in the public feed.</div>
      </div>
    </section>

    <!-- ARTIST DASHBOARD -->
    <section class="page authed" id="pageArtist" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Artist Dashboard</h2>
          <div class="muted">Create a project, pick a creator, request a shoot date, and track progress.</div>
        </div>
        <button class="btn" id="btnCreateProject">Create Project</button>
      </div>

      <div class="card">
        <div class="cardTitle">Your Wallet</div>
        <div class="row">
          <div class="pill big"><span id="walletBal">0</span> credits</div>
          <button class="btn ghost" id="btnBuyCredits">Buy credits (later)</button>
        </div>
        <div class="row">
          <input id="demoCredits" type="number" min="0" step="100" placeholder="Demo top-up (testing)" />
          <button class="btn" id="btnDemoCredits">Add</button>
        </div>
        <div class="muted">Stripe comes later. Demo credits are for testing right now.</div>
      </div>

      <div class="card">
        <div class="cardTitle">My Projects</div>
        <div id="artistProjects"></div>
      </div>
    </section>

    <!-- CREATOR DASHBOARD -->
    <section class="page authed" id="pageCreator" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Creator Dashboard</h2>
          <div class="muted" id="creatorApprovalNote"></div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="cardTitle">Your Packages</div>
          <div class="muted">You can have up to 4 packages: Bronze, Silver, Gold, Elite.</div>
          <div id="creatorPackages"></div>
        </div>

        <div class="card">
          <div class="cardTitle">Create / Update a Package</div>
          <div class="row">
            <select id="pkgService">
              <option value="music_video">Music Video</option>
              <option value="photography">Photography</option>
              <option value="reels">Reels / Shorts</option>
              <option value="editing">Editing</option>
              <option value="fashion">Fashion (Rent)</option>
              <option value="producer">Producer</option>
            </select>
            <select id="pkgTier">
              <option value="bronze">Bronze</option>
              <option value="silver">Silver</option>
              <option value="gold">Gold</option>
              <option value="elite">Elite</option>
            </select>
          </div>
          <input id="pkgTitle" placeholder="Package title (ex: Bronze Music Video)" />
          <div class="row">
            <input id="pkgPrice" type="number" min="0" step="50" placeholder="Credits price" />
            <input id="pkgDelivery" type="number" min="1" step="1" placeholder="Delivery days" />
          </div>
          <div class="row">
            <input id="pkgHours" placeholder="Hours (ex: 4 hours)" />
            <input id="pkgLocations" placeholder="Locations (ex: 1–2)" />
          </div>
          <div class="row">
            <input id="pkgRevisions" placeholder="Revisions (ex: 1 revision)" />
          </div>
          <textarea id="pkgIncludes" placeholder="Includes (ex: Shooting + basic edit + color)"></textarea>
          <textarea id="pkgAddons" placeholder="Add-ons (ex: BTS video, 5 reels, extra locations)"></textarea>
          <div class="row">
            <button class="btn" id="btnSavePkg">Save Package</button>
          </div>
          <div class="muted">Creators can build packages anytime. You won’t appear publicly until approved.</div>
        </div>
      </div>

      <div class="card">
        <div class="cardTitle">Incoming Projects</div>
        <div id="creatorProjects"></div>
      </div>
    </section>

    <!-- CREATE PROJECT WIZARD -->
    <section class="page authed" id="pageCreateProject" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Create Project</h2>
          <div class="muted">Pick service → choose tier → pick creator → request a date → send message.</div>
        </div>
      </div>

      <div class="card">
        <div class="row">
          <select id="projService">
            <option value="music_video">Music Video</option>
            <option value="photography">Photography</option>
            <option value="reels">Reels / Shorts</option>
            <option value="editing">Editing</option>
            <option value="fashion">Fashion (Rent)</option>
            <option value="producer">Producer</option>
          </select>
          <select id="projTier">
            <option value="bronze">Bronze</option>
            <option value="silver">Silver</option>
            <option value="gold">Gold</option>
            <option value="elite">Elite</option>
          </select>
          <button class="btn" id="btnFindCreators">Find creators</button>
        </div>
        <div class="muted">LA only for now (city filter comes next).</div>
      </div>

      <div class="card">
        <div class="cardTitle">Pick a Creator</div>
        <div id="creatorResults" class="feed"></div>
        <div class="muted" id="creatorResultsEmpty" style="display:none;">No creators for that filter yet.</div>
      </div>

      <div class="card" id="requestBox" style="display:none;">
        <div class="cardTitle">Request details</div>
        <div class="row">
          <div class="pill">Creator: <span id="chosenCreator"></span></div>
          <div class="pill">Package: <span id="chosenPackage"></span></div>
          <div class="pill">Price: <span id="chosenPrice"></span></div>
        </div>
        <div class="row">
          <input id="reqDate" type="datetime-local" />
        </div>
        <textarea id="reqMsg" placeholder="Message (ex: vibe, references, location ideas, deadlines)"></textarea>
        <div class="row">
          <button class="btn" id="btnSendRequest">Send request</button>
          <button class="btn ghost" id="btnCancelRequest">Cancel</button>
        </div>
        <div class="muted">Availability calendar comes later. For MVP we request a date/time, creator confirms in chat.</div>
      </div>
    </section>

    <!-- MY PROJECTS -->
    <section class="page authed" id="pageProjects" style="display:none;">
      <h2>My Projects</h2>
      <div class="muted">Track every project from request to final delivery.</div>
      <div id="projectsAll"></div>
    </section>

    <!-- SETTINGS -->
    <section class="page authed" id="pageSettings" style="display:none;">
      <h2>Settings</h2>
      <div class="card">
        <div class="row">
          <label class="lbl">Display name</label>
          <input id="setName" />
        </div>
        <div class="row">
          <label class="lbl">City</label>
          <input id="setCity" />
        </div>
        <div class="row">
          <label class="lbl">Role</label>
          <select id="setRole">
            <option value="client">Artist (Client)</option>
            <option value="creator">Creator</option>
          </select>
        </div>
        <div class="row">
          <label class="lbl">Bio</label>
          <textarea id="setBio"></textarea>
        </div>
        <div class="row">
          <label class="lbl">Portfolio link</label>
          <input id="setPortfolio" />
        </div>
        <div class="row">
          <label class="lbl">Resume link</label>
          <input id="setResume" />
        </div>
        <div class="row">
          <button class="btn" id="btnSaveSettings">Save</button>
        </div>
        <div class="muted">Creators must be approved to appear publicly. Artists can book anytime.</div>
      </div>
    </section>

  </main>

  <!-- AUTH MODAL -->
  <div class="modal" id="authModal" style="display:none;">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">Sign in / Create account</div>
        <button class="x" id="authClose">✕</button>
      </div>

      <div id="authStepRole">
        <div class="muted" style="margin-bottom:10px;">First choose what you are. You can change later.</div>
        <div class="roleSplit" style="margin-top:0;">
          <button class="roleCard" id="authPickArtist">
            <div class="roleTitle">Artist</div>
            <div class="roleSub">Book projects</div>
          </button>
          <button class="roleCard" id="authPickCreator">
            <div class="roleTitle">Creator</div>
            <div class="roleSub">Get booked</div>
          </button>
        </div>
      </div>

      <div id="authStepEmail" style="display:none;">
        <div class="muted" style="margin-bottom:10px;">Enter your email. We’ll send a magic link.</div>
        <input id="email" placeholder="you@email.com" />
        <button class="btn" id="btnSendLink" style="width:100%; margin-top:10px;">Send magic link</button>
        <button class="btn ghost" id="btnBackRole" style="width:100%; margin-top:10px;">Back</button>
        <div class="muted" style="margin-top:10px;">Tip: check Promotions/Spam.</div>
      </div>

      <div id="authStepSent" style="display:none;">
        <div class="modalTitle" style="margin-bottom:6px;">Link sent ✅</div>
        <div class="muted">Open your email and click the link. This tab will log in automatically.</div>
      </div>

    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script src="assets/app.js"></script>
</body>
</html>
