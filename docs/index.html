<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>CreatorBook</title>

  <!-- Theme + tiny favicon (no 404 noise) -->
  <meta name="theme-color" content="#06060a" />
  <link rel="icon" href="data:," />

  <!-- IMPORTANT: reduce “finicky” cache behavior across browsers -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- Preconnect helps Supabase/auth feel snappier -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Versioned assets: bump ?v= when you deploy changes -->
  <link rel="stylesheet" href="assets/style.css?v=13" />

  <!-- Base path single source of truth (prevents /creatorbook/creatorbook drift) -->
  <script>
    // GitHub Pages base for this repo
    // Auto-detect GitHub Pages base. Works for /creatorbook/, /creatorbook-main/, or custom domains.
    (function(){
      const p = location.pathname || "/";
      // If deployed as /REPO/..., base is "/REPO/". If custom domain, base is "/".
      const parts = p.split("/").filter(Boolean);
      window.CREATORBOOK_BASE = (parts.length ? ("/" + parts[0] + "/") : "/");
    })();
    // Optional: helpful for debug in console
    window.CREATORBOOK_BUILD = "index-v10";
  </script>

  <!-- Load scripts deferred so UI renders reliably before JS runs -->
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script defer src="config.js?v=12"></script>
  <script defer src="assets/app.js?v=13"></script>
</head>

<body>
  <noscript style="color:#fff; padding:16px; display:block; max-width:900px; margin:20px auto;">
    CreatorBook needs JavaScript enabled to sign in and create accounts.
  </noscript>

  <div class="bg"></div>

  <header class="topbar">
    <a class="brand" href="#home" data-nav="home" aria-label="CreatorBook Home">
      <span class="dot"></span>
      <span class="name">CREATORBOOK</span>
    </a>

    <nav class="nav">
      <a href="#home" data-nav="home" id="navHome">Home</a>
      <a href="#browse" data-nav="browse" id="navBrowse">Browse</a>
      <a href="#create" data-nav="create" id="navCreate">Create</a>
      <a href="#projects" data-nav="projects" id="navProjects">My Projects</a>
    </nav>

    <div class="right">
      <div class="pill authed" id="creditsPill" style="cursor:pointer;" title="Credits">
        <span id="creditsBalTop">0</span>
        <span class="sep">·</span>
        <span>credits</span>
        <span class="sep">·</span>
        <button class="miniLink" id="btnBuyCredits" type="button" title="Buy credits">Buy credits</button>
      </div>

      <div class="menuWrap authed" id="profileMenuWrap">
        <button class="btn ghost" id="btnProfile"><span id="whoName">Menu</span> ▾</button>
        <div class="menu" id="profileMenu" style="display:none;">
          <a href="#post" id="menuHome">Home</a>
          <a href="#projects" id="menuProjects">My Projects</a>
          <a href="#profile" id="menuProfile">Profile</a>
          <button class="menuBtn" id="menuSignOut">Sign out</button>
        </div>
      </div>

      <button class="btn ghost" id="btnSignIn">Sign in</button>
    </div>
  </header>

  <main class="wrap">

    <!-- PUBLIC HOME (no login required) -->
    <section class="page show" id="pagePost">
      <h1 class="heroTitle">Book LA creatives with tiers, credits, and a clean workflow.</h1>
      <p class="heroSub">Browse first. Sign in when you’re ready to book, sell, or collaborate.</p>

      <div class="heroCtas" id="homePublicCtas">
        <button class="btn" id="homeCtaCreatePkg" type="button">Create Package</button>
        </div>
<div class="row" style="justify-content:center; gap:10px; margin:16px 0 8px;">
        <button class="chip active" id="homeTabPosts" type="button">Community</button>
        <button class="chip" id="homeTabPackages" type="button">Creator packages</button>
      </div>

      <div id="homePostsWrap">
        <div class="card">
          <div class="row" style="justify-content:space-between; align-items:center;">
            <div class="cardTitle" style="margin:0;">Community Posts</div>
            <select id="postsSort" style="max-width:180px;">
              <option value="recent">Recent</option>
              <option value="popular">Popular (all time)</option>
            </select>
          </div>
          <div class="muted">Public updates from users. Post from Profile → My Feed.</div>
          <div id="publicPosts" class="feed" style="margin-top:10px;"></div>
          <div class="muted" id="publicPostsEmpty" style="display:none;">No posts yet.</div>
        </div>
      </div>

      <div id="homePackagesWrap" style="display:none;">

        <div class="grid2">
          <div class="card">
            <div class="cardTitle">Explore</div>
            <div class="row">
              <select id="homeService">
                <option value="any">Any service</option>
                <option value="music_video">Music Video</option>
                <option value="photography">Photography</option>
                <option value="reels">Reels / Shorts</option>
                <option value="editing">Editing</option>
                <option value="fashion">Fashion (Rent)</option>
                <option value="producer">Producer</option>
              </select>
              <select id="homeTier">
                <option value="any">Any tier</option>
                <option value="bronze">Bronze</option>
                <option value="silver">Silver</option>
                <option value="gold">Gold</option>
                <option value="elite">Elite</option>
              </select>
              <button class="btn" id="homeRefresh">Refresh</button>
            </div>
            <div class="muted">This feed shows approved creators and their packages.</div>
          </div>

          <div class="card">
            <div class="cardTitle">How it works</div>
            <ol class="steps">
              <li>Browse creators + tiers.</li>
              <li>Sign in, choose Artist or Creator.</li>
              <li>Artists create a project → pick a creator → request a date → chat.</li>
              <li>Credits go into escrow when confirmed. Delivery → approval → rating.</li>
            </ol>
          </div>
        </div>

        <div class="card">
          <div class="cardTitle">Approved creators</div>
          <div id="feed" class="feed"></div>
          <div class="muted" id="feedEmpty" style="display:none;">No packages found. Try “Any”.</div>
        </div>

      </div>
    </section>
<!-- ARTIST DASHBOARD -->
    <section class="page authed" id="pageArtist" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Artist Dashboard</h2>
          <div class="muted">Create a project, pick a creator, request a shoot date, and track progress.</div>
        </div>
        <button class="btn" id="btnCreateProject">Create Project</button>
      </div>

      <div class="card">
        <div class="cardTitle">Your Wallet</div>
        <div class="row">
          <div class="pill big"><span id="walletBal">0</span> credits</div>
          <button class="btn ghost" id="btnBuyCredits">Buy credits (later)</button>
        </div>
        <div class="row">
          <input id="demoCredits" type="number" min="0" step="100" placeholder="Demo top-up (testing)" />
          <button class="btn" id="btnDemoCredits">Add</button>
        </div>
        <div class="muted">Stripe comes later. Demo credits are for testing right now.</div>
      </div>

      <div class="card">
        <div class="cardTitle">My Projects</div>
        <div id="artistProjects"></div>
      </div>
    </section>

    <!-- CREATOR DASHBOARD -->
    <section class="page authed" id="pageCreator" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Creator Dashboard</h2>
          <div class="muted" id="creatorApprovalNote"></div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="cardTitle">Your Packages</div>
          <div class="muted">You can have up to 4 packages: Bronze, Silver, Gold, Elite.</div>
          <div id="creatorPackages"></div>
        </div>

        <div class="card">
          <div class="cardTitle">Create / Update a Package</div>
          <div class="row">
            <select id="pkgService">
              <option value="music_video">Music Video</option>
              <option value="photography">Photography</option>
              <option value="reels">Reels / Shorts</option>
              <option value="editing">Editing</option>
              <option value="fashion">Fashion (Rent)</option>
              <option value="producer">Producer</option>
            </select>
            <select id="pkgTier">
              <option value="bronze">Bronze</option>
              <option value="silver">Silver</option>
              <option value="gold">Gold</option>
              <option value="elite">Elite</option>
            </select>
          </div>
          <input id="pkgTitle" placeholder="Package title (ex: Bronze Music Video)" />
          <div class="row">
            <input id="pkgPrice" type="number" min="0" step="50" placeholder="Credits price" />
            <input id="pkgDelivery" type="number" min="1" step="1" placeholder="Delivery days" />
          </div>
          <div class="row">
            <input id="pkgHours" placeholder="Hours (ex: 4 hours)" />
            <input id="pkgLocations" placeholder="Locations (ex: 1–2)" />
          </div>
          <div class="row">
            <input id="pkgRevisions" placeholder="Revisions (ex: 1 revision)" />
          </div>
          <textarea id="pkgIncludes" placeholder="Includes (ex: Shooting + basic edit + color)"></textarea>
          <textarea id="pkgAddons" placeholder="Add-ons (ex: BTS video, 5 reels, extra locations)"></textarea>
          <div class="row">
            <button class="btn" id="btnSavePkg">Save Package</button>
          </div>
          <div class="muted">Creators can build packages anytime. You won’t appear publicly until approved.</div>
        </div>
      </div>

      <div class="card">
        <div class="cardTitle">Incoming Projects</div>
        <div id="creatorProjects"></div>
      </div>
    </section>

    <!-- PROFILE -->
    <section class="page authed" id="pageProfile" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Profile</h2>
          <div class="muted">Projects, your feed, and your settings in one spot.</div>
        </div>
        <div class="pill big" title="Credits"><span id="profileCredits">0</span> credits</div>
      </div>

      <div class="profileHero">
        <div class="avatar" id="profileAvatar">U</div>
        <div>
          <div class="profileName" id="profileName">User</div>
          <div class="profileMeta"><span id="profileRole">client</span> · <span id="profileCity">Los Angeles</span></div>
        </div>
      </div>

      <div class="tabs" role="tablist" aria-label="Profile tabs">
        <button class="tabBtn active" id="tabProjects" type="button">My Projects</button>
        <button class="tabBtn" id="tabFeed" type="button">My Feed</button>
        <button class="tabBtn" id="tabSettings" type="button">Settings</button>
      </div>

      <div class="tabPanel" id="panelProjects">
        <div class="card">
          <div class="cardTitle">My Projects</div>
          <div class="muted">All your bookings, with status + checklist.</div>
          <div id="profileProjects"></div>
        </div>
      </div>

      <div class="tabPanel" id="panelFeed" style="display:none;">
        <div class="grid2">
          <div class="card">
            <div class="cardTitle">Home</div>
            <div class="muted">For now this is demo-only (local). We can add tables later for real follows/likes.</div>
            <input id="postTitle" placeholder="Title (optional)" />
            <textarea id="postBody" placeholder="Drop a link or an update… (YouTube / IG / Vimeo links work great)"></textarea>
            <div class="row">
              <button class="btn" id="btnPost">Home</button>
              <button class="btn ghost" id="btnClearPosts">Clear</button>
            </div>
          </div>
          <div class="card">
            <div class="cardTitle">Your Posts</div>
            <div id="myFeed" class="feed"></div>
            <div class="muted" id="myFeedEmpty" style="display:none;">No posts yet.</div>
          </div>
        </div>
      </div>

      <div class="tabPanel" id="panelSettings" style="display:none;">
        <div class="card">
          <div class="cardTitle">Settings</div>
          <div class="formGrid">
            <div class="formRow">
              <label class="lbl">Display name</label>
              <input id="setName2" />
            </div>

            <div class="formRow">
              <label class="lbl">Profile photo URL</label>
              <input id="setAvatar2" placeholder="https://.../your-photo.jpg" />
            </div>

            <div class="formRow">
              <label class="lbl">City</label>
              <input id="setCity2" />
            </div>

            <div class="formRow">
              <label class="lbl">Role</label>
              <select id="setRole2">
                <option value="client">Artist (Client)</option>
                <option value="creator">Creator</option>
              </select>
            </div>

            <div class="formRow">
              <label class="lbl">Bio</label>
              <textarea id="setBio2"></textarea>
            </div>

            <div class="formRow">
              <label class="lbl">Highlight / Portfolio link</label>
              <input id="setPortfolio2" />
            </div>

            <div class="formRow">
              <label class="lbl">Resume link</label>
              <input id="setResume2" />
            </div>

            <div class="row" style="justify-content:flex-end;">
              <button class="btn" id="btnSaveSettings2">Save</button>
            </div>
          </div>
<div class="muted">Creators must be approved to appear publicly. Artists can book anytime.</div>
        </div>
      </div>
    </section>

    <!-- CREATE PACKAGE -->
    <section class="page authed" id="pageCreatePackage" style="display:none;">
      <div class="pageHead">
        <div>
          <h2>Create Package</h2>
          <div class="muted">List a service with tier options. You can sell and book on the same account.</div>
        </div>
      </div>

      <div class="card">
        <div class="row">
          <select id="pkgService">
            <option value="music_video">Music Video</option>
            <option value="photography">Photography</option>
            <option value="reels">Reels / Shorts</option>
            <option value="editing">Editing</option>
            <option value="fashion">Fashion (Rent)</option>
            <option value="producer">Producer</option>
            <option value="other">Other</option>
          </select>
          <input id="pkgTitle" placeholder="Package title (e.g., 'Moody Night Photoshoot')" />
          <button class="btn" id="btnLoadMyPkgs" type="button">Load my packages</button>
        </div>

        <div class="muted" style="margin-top:8px;">
          Tip: Start with 3 tiers. Keep “Elite” for add-ons or all-day shoots.
        </div>
      </div>

      <div class="grid2" style="margin-top:12px;">
        <div class="card tierCard" data-tier="bronze">
          <div class="row" style="justify-content:space-between; align-items:center;">
            <div class="cardTitle" style="margin:0;">Bronze</div>
            <label class="row" style="gap:8px; margin:0;">
              <input type="checkbox" id="tierOn_bronze" checked />
              <span class="muted">Active</span>
            </label>
          </div>
          <div class="row" style="margin-top:10px;">
            <input id="tierPrice_bronze" type="number" min="0" placeholder="Price (credits)" />
            <input id="tierDays_bronze" type="number" min="0" placeholder="Delivery days" />
          </div>
          <textarea id="tierIncludes_bronze" placeholder="What’s included (1–3 lines)."></textarea>
          <textarea id="tierAddons_bronze" placeholder="Add-ons (optional)."></textarea>
        </div>

        <div class="card tierCard" data-tier="silver">
          <div class="row" style="justify-content:space-between; align-items:center;">
            <div class="cardTitle" style="margin:0;">Silver</div>
            <label class="row" style="gap:8px; margin:0;">
              <input type="checkbox" id="tierOn_silver" checked />
              <span class="muted">Active</span>
            </label>
          </div>
          <div class="row" style="margin-top:10px;">
            <input id="tierPrice_silver" type="number" min="0" placeholder="Price (credits)" />
            <input id="tierDays_silver" type="number" min="0" placeholder="Delivery days" />
          </div>
          <textarea id="tierIncludes_silver" placeholder="What’s included (1–3 lines)."></textarea>
          <textarea id="tierAddons_silver" placeholder="Add-ons (optional)."></textarea>
        </div>

        <div class="card tierCard" data-tier="gold">
          <div class="row" style="justify-content:space-between; align-items:center;">
            <div class="cardTitle" style="margin:0;">Gold</div>
            <label class="row" style="gap:8px; margin:0;">
              <input type="checkbox" id="tierOn_gold" checked />
              <span class="muted">Active</span>
            </label>
          </div>
          <div class="row" style="margin-top:10px;">
            <input id="tierPrice_gold" type="number" min="0" placeholder="Price (credits)" />
            <input id="tierDays_gold" type="number" min="0" placeholder="Delivery days" />
          </div>
          <textarea id="tierIncludes_gold" placeholder="What’s included (1–3 lines)."></textarea>
          <textarea id="tierAddons_gold" placeholder="Add-ons (optional)."></textarea>
        </div>

        <div class="card tierCard" data-tier="elite">
          <div class="row" style="justify-content:space-between; align-items:center;">
            <div class="cardTitle" style="margin:0;">Elite</div>
            <label class="row" style="gap:8px; margin:0;">
              <input type="checkbox" id="tierOn_elite" />
              <span class="muted">Active</span>
            </label>
          </div>
          <div class="row" style="margin-top:10px;">
            <input id="tierPrice_elite" type="number" min="0" placeholder="Price (credits)" />
            <input id="tierDays_elite" type="number" min="0" placeholder="Delivery days" />
          </div>
          <textarea id="tierIncludes_elite" placeholder="What’s included (1–3 lines)."></textarea>
          <textarea id="tierAddons_elite" placeholder="Add-ons (optional)."></textarea>
        </div>
      </div>

      <div class="row" style="margin-top:12px; justify-content:flex-end;">
        <button class="btn ghost" id="btnClearPkgForm" type="button">Clear</button>
        <button class="btn" id="btnSavePkg" type="button">Save tiers</button>
      </div>

      <div class="card" style="margin-top:14px;">
        <div class="row" style="justify-content:space-between; align-items:center;">
          <div class="cardTitle" style="margin:0;">My Packages</div>
          <button class="btn ghost" id="btnRefreshMyPkgs" type="button">Refresh</button>
        </div>
        <div class="muted">Tap a row to load it into the editor.</div>
        <div id="myPackagesList" class="feed" style="margin-top:10px;"></div>
        <div class="muted" id="myPackagesEmpty" style="display:none;">No packages yet.</div>
      </div>
    </section>
<!-- MY PROJECTS -->
    <section class="page authed" id="pageProjects" style="display:none;">
      <h2>My Projects</h2>
      <div class="muted">Track every project from request to final delivery.</div>
      <div id="projectsAll"></div>
    </section>

    <!-- SETTINGS -->
    <section class="page authed" id="pageSettings" style="display:none;">
      <h2>Settings</h2>
      <div class="card">
        <div class="row">
          <label class="lbl">Display name</label>
          <input id="setName" />
        </div>
        <div class="row">
          <label class="lbl">City</label>
          <input id="setCity" />
        </div>
        <div class="row">
          <label class="lbl">Role</label>
          <select id="setRole">
            <option value="client">Artist (Client)</option>
            <option value="creator">Creator</option>
          </select>
        </div>
        <div class="row">
          <label class="lbl">Bio</label>
          <textarea id="setBio"></textarea>
        </div>
        <div class="row">
          <label class="lbl">Portfolio link</label>
          <input id="setPortfolio" />
        </div>
        <div class="row">
          <label class="lbl">Resume link</label>
          <input id="setResume" />
        </div>
        <div class="row">
          <button class="btn" id="btnSaveSettings">Save</button>
        </div>
        <div class="muted">Creators must be approved to appear publicly. Artists can book anytime.</div>
      </div>
    </section>

  </main>

  <!-- AUTH MODAL -->
  <div class="modal" id="authModal" style="display:none;">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">Welcome</div>
        <button class="x" id="authClose" aria-label="Close">✕</button>
      </div>

      <div class="authMode" role="tablist" aria-label="Authentication mode">
        <button class="chip active" id="authModeLogin" type="button" role="tab" aria-selected="true">Sign in</button>
        <button class="chip" id="authModeSignup" type="button" role="tab" aria-selected="false">Create account</button>
      </div>

      <div class="muted tiny" id="authModeHelp">New here? Create an account. Already a member? Sign in.</div>

      <div class="authStack">
        <button class="btn google" id="authGoogle">
          <span class="gDot" aria-hidden="true"></span>
          Continue with Google
        </button>

        <div class="divider"><span>or</span></div>

        <label class="lbl">Email</label>
        <input id="authEmail" placeholder="Email (username sign-in coming)" autocomplete="email" />

        <label class="lbl">Password</label>
        <input id="authPass" type="password" placeholder="••••••••" autocomplete="current-password" />

        <div id="authPass2Wrap" style="display:none;">
          <label class="lbl">Confirm password</label>
          <input id="authPass2" type="password" placeholder="••••••••" autocomplete="new-password" />
        </div>

        <div id="authPhoneWrap" style="display:none;">
          <label class="lbl">Phone (optional)</label>
          <input id="authPhone" placeholder="(323) 555-5555" autocomplete="tel" />
        </div>

        <div id="authRoleWrap" style="display:none; margin-top:10px;">
          <label class="lbl">I am signing up as</label>
          <select id="authRole" class="select">
            <option value="client">Artist (booking)</option>
            <option value="creator">Creator (service provider)</option>
          </select>
          <div class="muted tiny" style="margin-top:6px;">You can switch later in Profile settings.</div>
        </div>

        <div class="authRow">
          <button class="btn" id="authLogin" type="button">Sign in</button>
          <button class="btn ghost" id="authSignup" type="button">Create account</button>
        </div>

        <div class="authRow" style="margin-top:10px; justify-content:space-between;">
          <button class="btn ghost small" id="authForgot" type="button">Forgot password?</button>
          <button class="btn" id="authSetNewPass" type="button" style="display:none;">Set new password</button>
        </div>

        <button class="btn ghost small" id="authMagic" type="button">Magic link</button>

        <div class="muted tiny" style="display:flex; justify-content:space-between; gap:10px; align-items:center;">
          <button class="miniLink" id="authGoSignup" type="button">Don’t have an account? Create one</button>
          <button class="miniLink" id="authGoLogin" type="button" style="display:none;">Already have an account? Sign in</button>
        </div>

        <div class="muted tiny" id="authHint">
          Tip: If email confirmation is on, we’ll prompt you to confirm your email, then you can sign in.
        </div>
      </div>

    </div>
  </div>

  <!-- Onboarding Modal -->
  <div class="modal" id="onboardModal" style="display:none;">
    <div class="sheet">
      <div class="modalHead">
        <div class="modalTitle">Get started</div>
        <button class="x" id="onboardClose" aria-label="Close">✕</button>
      </div>

      <div class="card" style="margin:0;">
        <div class="muted">
          Here’s how CreatorBook works:
          <ul style="margin:10px 0 0 18px; padding:0;">
            <li>Browse creators publicly, no login needed.</li>
            <li>Artists create projects, pick a tier, request a date, and message.</li>
            <li>Creators build packages (Bronze → Elite). Admin approves creators for the public feed.</li>
          </ul>
        </div>
      </div>
      </div>
    </div>
  </div>

  <!-- Credits Modal -->
  <div class="modal" id="creditsModal" style="display:none;">
    <div class="sheet">
      <div class="modalTitle">Credits</div>
      <div class="muted" style="margin-bottom:10px;">For now this is demo top-up. Later we wire Stripe to buy credits.</div>
      <div class="row">
        <input id="demoCreditsModal" type="number" min="0" step="1" placeholder="500" />
        <button class="btn" id="btnAddDemoCreditsModal">Add</button>
      </div>
      <div class="muted" style="margin-top:10px;">Balance: <b><span id="walletBalModal">0</span></b> credits</div>
      <div class="row" style="margin-top:12px; justify-content:flex-end;">
        <button class="btn ghost" id="btnCloseCredits">Close</button>
      </div>
    </div>
  </div>

  
  <!-- Booking Modal -->
  <div class="modal" id="bookModal" style="display:none;">
    <div class="sheet">
      <div class="modalTitle">Request Booking</div>
      <div class="muted" id="bookModalSub" style="margin-bottom:10px;">Pick a date and send details.</div>

      <div class="card" style="margin:10px 0;">
        <div class="cardTitle" id="bookPkgTitle" style="margin:0;">Package</div>
        <div class="muted" id="bookPkgMeta"></div>
        <div class="row" style="margin-top:10px;">
          <input id="bookReqDate" type="date" />
          <input id="bookCredits" type="number" min="0" step="1" placeholder="Credits" />
        </div>
        <textarea id="bookNotes" placeholder="Describe your project (location, vibe, references, deadlines)."></textarea>
      </div>

      <div class="row" style="justify-content:flex-end; gap:10px;">
        <button class="btn ghost" id="btnCloseBook" type="button">Cancel</button>
        <button class="btn" id="btnSendBook" type="button">Send request</button>
      </div>
    </div>
  </div>


  <div id="toast" class="toast"></div>
</body>
</html>
